{"version":3,"sources":["webpack://@lenna-project/watermark/./src/Widget.vue?29e7","webpack://@lenna-project/watermark/./src/Widget.vue","webpack://@lenna-project/watermark/./src/Widget.vue?f39d","webpack://@lenna-project/watermark/./src/Widget.vue?01bc","webpack://@lenna-project/watermark/./src/payment.js","webpack://@lenna-project/watermark/./src/index.js","webpack://@lenna-project/watermark/ignored|/home/runner/work/lenna-plugins-extra/lenna-plugins-extra/watermark/node_modules/bn.js/lib|buffer"],"names":[],"mappings":";;;;;AAAA,uC;;;;;;;;;;;;;;;;;;;;;;;gCCSM,4CAAkB,eAAX,KAAG;gCAEV,4CAAkB,eAAX,KAAG;;;;uDAVd,4CAaM;IAZJ,4CAIO;MAHL,KAAK,EAAC,qBAAqB;MAC1B,KAAK,+BAA+B,iBAAY;MAChD,OAAK,0CAAE,6CAAW;;IAErB,4CAAuD;MAAhD,GAAG,EAAC,WAAW;MAAC,IAAI,EAAC,MAAM;MAAE,OAAK,0CAAE,uCAAQ;;IACnD,4CAKM;MAJJ,UAAkB;qDAClB,4CAAmE;QAA5D,IAAI,EAAC,QAAQ;oEAAiB,MAAC;QAAG,QAAM,uCAAE,iBAAY;;;;UAAxB,MAAC;;oBAAjB,IAAkB;;;MACvC,UAAkB;qDAClB,4CAAmE;QAA5D,IAAI,EAAC,QAAQ;oEAAiB,MAAC;QAAG,QAAM,uCAAE,iBAAY;;;;UAAxB,MAAC;;oBAAjB,IAAkB;;;;;;;;;;AAMP;AACtC,oEAAe,+CAAe,CAAC;EAC7B,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACvB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACvB,CAAC;EACD,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACL,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;MAClB,CAAC,EAAE,CAAC;MACJ,CAAC,EAAE,CAAC;IACN,CAAC;EACH,CAAC;EACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACP,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9B,CAAC;IACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACT,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAChC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACtB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;QACnB,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE;UACrB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACnC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACrB,CAAC;QACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC9B;IACF,CAAC;IACD,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACnB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC9B,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC9B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MACxC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;QACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACpB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACT,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACX,CAAC;MACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACpC,CAAC;EACH,CAAC;EACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACR,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAChD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAChE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACrB,CAAC;AACH,CAAC,CAAC,EAAC;;;AClEmI,C;;;;;;ACAvD;AACtB;AACL;;AAEpD,CAA6E;AAC7E,oCAAa,GAAG,MAAM;AACtB,uCAAgB;;AAEhB,6CAAe,6B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRgD;AACrB;;AAE1C;;AAEA;AACA;AACA,+EAA+E,QAAQ,kDAAkD,OAAO;AAChJ;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,qCAAc,cAAc,0BAAgB;AACtD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,yBAAyB,cAAsB;AAC/C;AACA;;AAEA;AACA,gBAAgB,gCAAgC;AAChD;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA,yBAAyB,cAAsB;AAC/C;AACA;AACA;AACA;AACA;AACA,aAAa,0BAAgB;AAC7B;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEwB;;;;;AC1ExB,YAAY,kGAAgB;AACa;;AAEzC;AACA;;AAE8B;AACvB,WAAW,cAAM;AACjB;AACA,MAAM,QAAI;AACV;AACA;AACP,cAAc,OAAO;AACrB,gBAAgB,GAAG;AACnB;AACA;AACA;AACA,SAAS,kGAAgB;AACzB;AACO;AACP,UAAU;AACV;;;;;;;;ACrBA,e","file":"821.js","sourcesContent":["// extracted by mini-css-extract-plugin","<template>\n  <div>\n    <div\n      class=\"imagePreviewWrapper\"\n      :style=\"{ 'background-image': `url(${previewImage})` }\"\n      @click=\"selectImage\"\n    ></div>\n    <input ref=\"fileInput\" type=\"file\" @input=\"pickFile\" />\n    <div>\n      <label>x: </label>\n      <input type=\"number\" v-model.number=\"x\" @change=\"updateConfig()\" />\n      <label>y: </label>\n      <input type=\"number\" v-model.number=\"y\" @change=\"updateConfig()\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { defineComponent } from \"vue\";\nexport default defineComponent({\n  name: \"WatermarkWidget\",\n  props: {\n    defaultConfig: Object,\n  },\n  data() {\n    return {\n      previewImage: null,\n      x: 0,\n      y: 0,\n    };\n  },\n  methods: {\n    selectImage() {\n      this.$refs.fileInput.click();\n    },\n    pickFile() {\n      let input = this.$refs.fileInput;\n      let file = input.files;\n      if (file && file[0]) {\n        let reader = new FileReader();\n        reader.onload = (e) => {\n          this.previewImage = e.target.result;\n          this.updateConfig();\n        };\n        reader.readAsDataURL(file[0]);\n        this.$emit(\"input\", file[0]);\n      }\n    },\n    async updateConfig() {\n      if (!this.previewImage) return;\n      let watermark = this.previewImage\n        .replace(\"data:image/jpeg;base64,\", \"\")\n        .replace(\"data:image/png;base64,\", \"\");\n      let config = {\n        watermark: watermark,\n        x: this.x,\n        y: this.y,\n      };\n      this.$emit(\"changeConfig\", config);\n    },\n  },\n  created() {\n    this.previewImage = this.defaultConfig.watermark;\n    (this.x = this.defaultConfig.x), (this.y = this.defaultConfig.y);\n    this.updateConfig();\n  },\n});\n</script>\n\n<style scoped lang=\"css\">\n.imagePreviewWrapper {\n  width: 250px;\n  height: 250px;\n  display: block;\n  cursor: pointer;\n  margin: 0 auto 30px;\n  background-size: cover;\n  background-position: center center;\n}\n</style>","export { default } from \"-!../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[4].use[0]!./Widget.vue?vue&type=script&lang=js\"; export * from \"-!../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[4].use[0]!./Widget.vue?vue&type=script&lang=js\"","import { render } from \"./Widget.vue?vue&type=template&id=2a691264&scoped=true\"\nimport script from \"./Widget.vue?vue&type=script&lang=js\"\nexport * from \"./Widget.vue?vue&type=script&lang=js\"\n\nimport \"./Widget.vue?vue&type=style&index=0&id=2a691264&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-2a691264\"\n\nexport default script","import detectEthereumProvider from \"@metamask/detect-provider\";\nimport { utils, BigNumber } from \"ethers\";\n\nconst apiKey = \"YourApiKeyToken\";\n\nconst accountSent = async (address, payAddress, ethPrice) => {\n  return await fetch(\n    `https://api-kovan.etherscan.io/api?module=account&action=txlist&address=${address}&startblock=0&endblock=99999999&sort=asc&apikey=${apiKey}`\n  )\n    .then((response) => response.json())\n    .then((data) => {\n      let res = data.result.map(\n        (tx) =>\n          tx.to === payAddress.toLowerCase() &&\n          BigNumber.from(tx.value) >= utils.parseEther(ethPrice.toString())\n      );\n      return res;\n    })\n    .then((txs) => txs.includes(true))\n    .catch((e) => {\n      console.log(e);\n      return false;\n    });\n};\n\nconst isPayed = async (payAddress, ethPrice) => {\n  const provider = await detectEthereumProvider();\n  if (provider) {\n    const ethereum = window.ethereum;\n\n    let payed = await ethereum\n      .request({ method: \"eth_requestAccounts\" })\n      .then((accounts) => {\n        return Promise.all(\n          accounts.map((address) => accountSent(address, payAddress, ethPrice))\n        );\n      })\n      .catch((err) => {\n        if (err.code === 4001) {\n          console.log(\"Please connect to MetaMask.\");\n        } else {\n          console.error(err);\n        }\n      });\n    return payed.includes(true);\n  } else {\n    console.log(\"Please install MetaMask!\");\n    return false;\n  }\n};\n\nconst pay = async (payAddress, ethPrice) => {\n  const provider = await detectEthereumProvider();\n  if (provider) {\n    const ethereum = window.ethereum;\n    const transactionParameters = {\n      to: payAddress,\n      from: ethereum.selectedAddress,\n      value: utils.parseEther(ethPrice.toString()).toHexString(),\n    };\n\n    return await ethereum\n      .request({\n        method: \"eth_sendTransaction\",\n        params: [transactionParameters],\n      })\n      .then(() => true)\n      .catch((_error) => false);\n  } else {\n    console.log(\"Please install MetaMask!\");\n    return false;\n  }\n};\n\nexport { pay, isPayed };\n","const pkg = import(\"../pkg\");\nimport { isPayed, pay } from \"./payment\";\n\nconst payAddress = \"0xb81C8Fb3e8811C239406F39bdDDF056Ea4B8fF37\";\nconst ethPrice = 0.002;\n\nimport Widget from \"./Widget\";\nexport const ui = Widget;\nexport const processor = pkg;\nexport const name = () => \"watermark\";\nexport const description = () => \"Plugin to add watermark to image.\";\nexport const process = async (config, image) => {\n  if (!(await isPayed(payAddress, ethPrice))) {\n    if (!(await pay(payAddress, ethPrice))) {\n      return image;\n    }\n  }\n  return import(\"../pkg\").then((processor) => processor.process(config, image));\n};\nexport const defaultConfig = async () => {\n  return { watermark: \"\", x: 0, y: 0 };\n};\n","/* (ignored) */"],"sourceRoot":""}